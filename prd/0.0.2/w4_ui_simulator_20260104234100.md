# Agent å¹³å° UI Simulator åŸå‹ (v0.0.2 å¢é‡)

> æœ¬æ–‡æ¡£æ˜¯å¯¹ `prd/0.0.1/w4_ui_simulator_20260104160210.md` çš„å¢é‡æ›´æ–°ï¼Œä»…æè¿° 0.0.2 ç‰ˆæœ¬æ–°å¢çš„ UI ç»„ä»¶å’Œäº¤äº’ã€‚

---

## 1. UI Changes Summary

| å˜æ›´é¡¹ | ä½ç½® | ç±»å‹ |
|--------|------|------|
| è‡ªåŠ¨åˆ·æ–°æ§ä»¶ | Ticket åˆ—è¡¨é¡µ | **æ–°å¢** |
| Session è·³è½¬æŒ‰é’® | Ticket è¯¦æƒ…é¢æ¿ | **æ–°å¢** |
| åˆ›å»º Ticket æŒ‰é’® | Ticket åˆ—è¡¨é¡µ | **æ–°å¢** |
| åˆ›å»º Ticket å¼¹çª— | Ticket åˆ—è¡¨é¡µ | **æ–°å¢** |
| åŠ¨æ€è¡¨å•ç»„ä»¶ | åˆ›å»º Ticket å¼¹çª— | **æ–°å¢** |

---

## 2. UI Component Breakdown (æ–°å¢)

### 2.1 è‡ªåŠ¨åˆ·æ–°æ§ä»¶

| å±æ€§ | æè¿° |
|------|------|
| ä½ç½® | Ticket åˆ—è¡¨é¡µå³ä¸Šè§’ |
| é»˜è®¤çŠ¶æ€ | å¼€å¯ï¼Œ5 ç§’é—´éš” |
| äº¤äº’ | Toggle å¼€å…³ + å€’è®¡æ—¶æ˜¾ç¤º |

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Tickets                          ğŸ”„ Auto: 5s â—‰ ON  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [Ticket List...]                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 Session è·³è½¬æŒ‰é’®

| å±æ€§ | æè¿° |
|------|------|
| ä½ç½® | Ticket è¯¦æƒ…é¢æ¿ï¼ŒæŒ‰é’®ç»„å†… |
| æ¡ä»¶ | ä»…å½“ Ticket æœ‰å…³è” Session æ—¶æ˜¾ç¤º |
| è¡Œä¸º | ç‚¹å‡»è·³è½¬åˆ°æœ€æ–° Session è¯¦æƒ…é¡µ |

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ticket #abc12345         âœ•              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â— Suspended                             â”‚
â”‚                                         â”‚
â”‚ [Session] [Resume] [Reset]   â† æ–°å¢æŒ‰é’® â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 åˆ›å»º Ticket æŒ‰é’® + å¼¹çª—

| å±æ€§ | æè¿° |
|------|------|
| ä½ç½® | Ticket åˆ—è¡¨é¡µå³ä¸Šè§’ |
| äº¤äº’ | ç‚¹å‡»æ‰“å¼€åˆ›å»ºå¼¹çª— |

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Tickets              [+ Create Ticket] ğŸ”„ 5s â—‰     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
```

### 2.4 åŠ¨æ€è¡¨å•ç»„ä»¶

æ ¹æ® Agent çš„ `params_schema` åŠ¨æ€æ¸²æŸ“è¡¨å•å­—æ®µã€‚

| Schema ç±»å‹ | æ¸²æŸ“ç»„ä»¶ |
|-------------|----------|
| `string` | Text Input |
| `integer` | Number Input |
| `boolean` | Toggle / Checkbox |
| `array` | Multi-value Input |
| `object` | Nested Form |
| (æ—  schema) | JSON Text Area |

---

## 3. Wireframes

### 3.1 Ticket åˆ—è¡¨é¡µ (æ›´æ–°)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ« Tickets                                                       â”‚
â”‚                                                                   â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ [+ Create Ticket]        Auto Refresh: [5s â–¼] [â—‰ ON]       â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ #abc12345  â— RUNNING                                        â”‚ â”‚
â”‚ â”‚ ğŸ§  Code Assistant  â€¢  Jan 4, 23:40                          â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ #def67890  â— SUSPENDED                                      â”‚ â”‚
â”‚ â”‚ ğŸ§  Data Analyst  â€¢  Jan 4, 23:35                            â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 Ticket è¯¦æƒ…é¢æ¿ (æ›´æ–°)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ticket #abc12345                     âœ• â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â— SUSPENDED              [â–¸ Session]   â”‚  â† æ–°å¢ Session æŒ‰é’®
â”‚                          [â–¶ Resume]    â”‚
â”‚                          [â†º Reset]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Agent:       Code Assistant             â”‚
â”‚ Created:     Jan 4, 23:40               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Steps:                                  â”‚
â”‚   â— completed  åˆ†æä»£ç                  â”‚
â”‚   â— running    ç”ŸæˆæŠ¥å‘Š                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Context:                                â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ { "target": "/src/main.py" }        â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 åˆ›å»º Ticket å¼¹çª—

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Create Ticket                                    âœ• â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                     â”‚
â”‚ Agent: [Code Assistant â–¼]                           â”‚
â”‚                                                     â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ Parameters (æ ¹æ® Agent Schema åŠ¨æ€ç”Ÿæˆ)            â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚                                                     â”‚
â”‚ Target Path *                                       â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ /home/user/project                              â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                     â”‚
â”‚ Analysis Depth                                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ 3                                    [1 - 5]    â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                     â”‚
â”‚ Context (é€‰å¡«)                                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ { "goal": "Find bugs" }                         â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                     â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚                                                     â”‚
â”‚                    [Cancel]  [Create Ticket]        â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.4 æ—  Schema æ—¶çš„è¡¨å•

å½“ Agent æ²¡æœ‰å®šä¹‰ `params_schema` æ—¶ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Create Ticket                                    âœ• â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                     â”‚
â”‚ Agent: [Legacy Agent â–¼]                             â”‚
â”‚                                                     â”‚
â”‚ âš ï¸ This agent doesn't have a params schema.        â”‚
â”‚    Please enter raw JSON.                           â”‚
â”‚                                                     â”‚
â”‚ Parameters (JSON)                                   â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ {                                               â”‚â”‚
â”‚ â”‚   "key": "value"                                â”‚â”‚
â”‚ â”‚ }                                               â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                     â”‚
â”‚                    [Cancel]  [Create Ticket]        â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. State Transitions (æ–°å¢)

### Auto Refresh Flow

```mermaid
stateDiagram-v2
    [*] --> Enabled: Page Load
    Enabled --> Refreshing: Timer Tick (5s)
    Refreshing --> Enabled: API Response
    Enabled --> Disabled: User Toggle OFF
    Disabled --> Enabled: User Toggle ON
```

### Create Ticket Flow

```mermaid
stateDiagram-v2
    [*] --> Closed: Initial
    Closed --> Open: Click Create Button
    Open --> LoadingSchema: Select Agent
    LoadingSchema --> FormReady: Schema Loaded
    LoadingSchema --> FallbackForm: No Schema
    FormReady --> Submitting: Click Create
    FallbackForm --> Submitting: Click Create
    Submitting --> Success: API 201
    Submitting --> Error: API 4xx
    Success --> Closed: Auto Close
    Error --> FormReady: Show Error
```

---

## 5. UI State Table (æ–°å¢)

| View | Condition | UI State | Available Actions |
|------|-----------|----------|-------------------|
| Ticket List | Auto refresh ON | æ˜¾ç¤ºå€’è®¡æ—¶ | Toggle OFF, Pause on hover |
| Ticket List | Auto refresh OFF | æ˜¾ç¤ºåˆ·æ–°æŒ‰é’® | Toggle ON, Manual refresh |
| Ticket Detail | Has sessions | Session æŒ‰é’®å¯ç‚¹å‡» | Navigate to Session |
| Ticket Detail | No sessions | Session æŒ‰é’®ç¦ç”¨ | None |
| Create Modal | Agent selected | åŠ¨æ€è¡¨å•æ˜¾ç¤º | Fill form, Submit |
| Create Modal | No schema | JSON è¾“å…¥æ¡† | Enter JSON, Submit |

---

## 6. Component Implementation

### 6.1 AutoRefreshControl.jsx

```jsx
// frontend/src/components/AutoRefreshControl.jsx

import { useState, useEffect } from 'react';

export default function AutoRefreshControl({ 
  enabled, 
  interval = 5000, 
  onRefresh 
}) {
  const [countdown, setCountdown] = useState(interval / 1000);
  const [isEnabled, setIsEnabled] = useState(enabled);
  
  useEffect(() => {
    if (!isEnabled) return;
    
    const timer = setInterval(() => {
      setCountdown(prev => {
        if (prev <= 1) {
          onRefresh();
          return interval / 1000;
        }
        return prev - 1;
      });
    }, 1000);
    
    return () => clearInterval(timer);
  }, [isEnabled, interval, onRefresh]);
  
  return (
    <div className="flex items-center gap-2 text-sm">
      <span className="text-slate-400">Auto:</span>
      {isEnabled && (
        <span className="text-indigo-400 font-mono">{countdown}s</span>
      )}
      <button
        onClick={() => setIsEnabled(!isEnabled)}
        className={`px-2 py-1 rounded ${
          isEnabled 
            ? 'bg-indigo-600 text-white' 
            : 'bg-slate-700 text-slate-400'
        }`}
      >
        {isEnabled ? 'ON' : 'OFF'}
      </button>
    </div>
  );
}
```

### 6.2 CreateTicketModal.jsx

```jsx
// frontend/src/components/CreateTicketModal.jsx

import { useState, useEffect } from 'react';
import { api } from '../api/client';
import DynamicForm from './DynamicForm';

export default function CreateTicketModal({ isOpen, onClose, onCreated }) {
  const [agents, setAgents] = useState([]);
  const [selectedAgentId, setSelectedAgentId] = useState('');
  const [selectedAgent, setSelectedAgent] = useState(null);
  const [params, setParams] = useState({});
  const [context, setContext] = useState('');
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState(null);
  
  useEffect(() => {
    if (isOpen) {
      api.listAgents().then(setAgents);
    }
  }, [isOpen]);
  
  useEffect(() => {
    if (selectedAgentId) {
      api.getAgent(selectedAgentId).then(setSelectedAgent);
    }
  }, [selectedAgentId]);
  
  const handleSubmit = async () => {
    setLoading(true);
    setError(null);
    
    try {
      await api.createTicket({
        agent_id: selectedAgentId,
        params,
        context: context ? JSON.parse(context) : null,
      });
      onCreated();
      onClose();
    } catch (err) {
      setError(err.message);
    } finally {
      setLoading(false);
    }
  };
  
  if (!isOpen) return null;
  
  return (
    <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50">
      <div className="bg-slate-800 rounded-xl border border-slate-700 w-full max-w-lg p-6">
        <div className="flex justify-between items-center mb-4">
          <h2 className="text-lg font-semibold">Create Ticket</h2>
          <button onClick={onClose} className="text-slate-400 hover:text-white">âœ•</button>
        </div>
        
        {/* Agent Select */}
        <div className="mb-4">
          <label className="block text-sm text-slate-400 mb-1">Agent</label>
          <select
            value={selectedAgentId}
            onChange={e => setSelectedAgentId(e.target.value)}
            className="w-full bg-slate-900 border border-slate-600 rounded px-3 py-2"
          >
            <option value="">Select an Agent</option>
            {agents.map(a => (
              <option key={a.id} value={a.id}>{a.name}</option>
            ))}
          </select>
        </div>
        
        {/* Dynamic Form */}
        {selectedAgent && (
          <div className="mb-4">
            <label className="block text-sm text-slate-400 mb-1">Parameters</label>
            <DynamicForm
              schema={selectedAgent.params_schema}
              value={params}
              onChange={setParams}
            />
          </div>
        )}
        
        {/* Context */}
        <div className="mb-4">
          <label className="block text-sm text-slate-400 mb-1">Context (JSON, optional)</label>
          <textarea
            value={context}
            onChange={e => setContext(e.target.value)}
            className="w-full bg-slate-900 border border-slate-600 rounded px-3 py-2 h-24 font-mono text-sm"
            placeholder='{"goal": "..."}'
          />
        </div>
        
        {error && (
          <div className="mb-4 p-3 bg-red-500/20 border border-red-500/30 rounded text-red-400 text-sm">
            {error}
          </div>
        )}
        
        <div className="flex justify-end gap-2">
          <button onClick={onClose} className="px-4 py-2 bg-slate-700 rounded hover:bg-slate-600">
            Cancel
          </button>
          <button
            onClick={handleSubmit}
            disabled={!selectedAgentId || loading}
            className="px-4 py-2 bg-indigo-600 rounded hover:bg-indigo-500 disabled:opacity-50"
          >
            {loading ? 'Creating...' : 'Create Ticket'}
          </button>
        </div>
      </div>
    </div>
  );
}
```

### 6.3 DynamicForm.jsx

```jsx
// frontend/src/components/DynamicForm.jsx

export default function DynamicForm({ schema, value, onChange }) {
  // æ—  schema æ—¶æ˜¾ç¤º JSON è¾“å…¥æ¡†
  if (!schema || !schema.properties) {
    return (
      <div>
        <div className="text-amber-400 text-sm mb-2">
          âš ï¸ No schema defined. Enter raw JSON.
        </div>
        <textarea
          value={typeof value === 'string' ? value : JSON.stringify(value, null, 2)}
          onChange={e => {
            try {
              onChange(JSON.parse(e.target.value));
            } catch {
              onChange(e.target.value);
            }
          }}
          className="w-full bg-slate-900 border border-slate-600 rounded px-3 py-2 h-32 font-mono text-sm"
        />
      </div>
    );
  }
  
  // æœ‰ schema æ—¶åŠ¨æ€æ¸²æŸ“è¡¨å•
  return (
    <div className="space-y-3">
      {Object.entries(schema.properties).map(([key, prop]) => (
        <div key={key}>
          <label className="block text-sm text-slate-300 mb-1">
            {key} {schema.required?.includes(key) && <span className="text-red-400">*</span>}
          </label>
          {renderField(prop, value[key], v => onChange({ ...value, [key]: v }))}
        </div>
      ))}
    </div>
  );
}

function renderField(prop, value, onChange) {
  switch (prop.type) {
    case 'string':
      return (
        <input
          type="text"
          value={value || ''}
          onChange={e => onChange(e.target.value)}
          className="w-full bg-slate-900 border border-slate-600 rounded px-3 py-2 text-sm"
          placeholder={prop.description}
        />
      );
    case 'integer':
    case 'number':
      return (
        <input
          type="number"
          value={value ?? prop.default ?? ''}
          onChange={e => onChange(Number(e.target.value))}
          min={prop.minimum}
          max={prop.maximum}
          className="w-full bg-slate-900 border border-slate-600 rounded px-3 py-2 text-sm"
        />
      );
    case 'boolean':
      return (
        <label className="flex items-center gap-2">
          <input
            type="checkbox"
            checked={value ?? false}
            onChange={e => onChange(e.target.checked)}
            className="w-4 h-4"
          />
          <span className="text-sm text-slate-400">{prop.description}</span>
        </label>
      );
    default:
      return (
        <textarea
          value={typeof value === 'string' ? value : JSON.stringify(value, null, 2)}
          onChange={e => {
            try { onChange(JSON.parse(e.target.value)); } 
            catch { onChange(e.target.value); }
          }}
          className="w-full bg-slate-900 border border-slate-600 rounded px-3 py-2 h-20 font-mono text-sm"
        />
      );
  }
}
```

---

## 7. Verification Checklist

### è‡ªåŠ¨åˆ·æ–°
- [ ] é¡µé¢åŠ è½½åè‡ªåŠ¨å¼€å§‹åˆ·æ–°
- [ ] å€’è®¡æ—¶æ˜¾ç¤ºæ­£ç¡®
- [ ] Toggle OFF ååœæ­¢åˆ·æ–°
- [ ] Toggle ON åæ¢å¤åˆ·æ–°
- [ ] åˆ·æ–°æ—¶ä¿æŒæ»šåŠ¨ä½ç½®
- [ ] åˆ·æ–°æ—¶ä¿æŒé€‰ä¸­çŠ¶æ€

### Session è·³è½¬
- [ ] æœ‰ Session æ—¶æŒ‰é’®å¯ç‚¹å‡»
- [ ] æ—  Session æ—¶æŒ‰é’®ç¦ç”¨å¹¶æ˜¾ç¤º tooltip
- [ ] ç‚¹å‡»è·³è½¬åˆ°æ­£ç¡®çš„ Session é¡µé¢

### åˆ›å»º Ticket
- [ ] ç‚¹å‡»æŒ‰é’®æ‰“å¼€å¼¹çª—
- [ ] Agent ä¸‹æ‹‰åˆ—è¡¨æ­£ç¡®åŠ è½½
- [ ] é€‰æ‹© Agent ååŠ¨æ€æ¸²æŸ“è¡¨å•
- [ ] æ—  schema æ—¶æ˜¾ç¤º JSON è¾“å…¥æ¡†
- [ ] å¿…å¡«å­—æ®µéªŒè¯
- [ ] åˆ›å»ºæˆåŠŸåå…³é—­å¼¹çª—å¹¶åˆ·æ–°åˆ—è¡¨
- [ ] åˆ›å»ºå¤±è´¥æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
